---
title: "WSL 2 ä¸Šã® Debian ã§  systemd ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ§"
type: "tech"
topics: ["WSL", "Debian", "wslconf", "systemd"  ]
published: true
---

## tl;dr

WSL 2 ä¸Šã® Debian ã§ systemd ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€Linux ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’ä½¿ã£ãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’æ´»ç”¨ã§ãã¾ã™ã€‚

1. `/etc/wsl.conf` ã® `[boot]` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« `systemd=true` ã‚’è¿½åŠ 
2. `wsl --terminate Debian` ã¨ã—ã¦ã€Debian ã‚’åœæ­¢
3. `Windows Terminal` ä¸Šã§ Debian ã‚’èµ·å‹•

ä»¥ä¸Šã§ã€WSL2 ä¸Šã® Debian ã§ systemd ã‚’ä½¿ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

## ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã§ã¯ã€WSL 2[^1] ä¸Šã® Debian ã§ systemd[^2] ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
systemd ã¯ Linux ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

WSL2 ã§ systemd ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã“ã¨ã§ã€Linux ã®æ©Ÿèƒ½ã‚’ Windowsä¸Šã§ã‚‚æ´»ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

[^1]: WSL: Windows Subsystem for Linux ã®ç•¥ã§ã€Windows ä¸Šã§ Linux ã‚’å®Ÿè¡Œã•ã›ã‚‹ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ 
[^2]: systemd: Linux ã®ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ãŠã‚ˆã³åˆæœŸåŒ–ã‚·ã‚¹ãƒ†ãƒ 

## 1. `/etc/wsl.conf` ã®è¨­å®š

WSL ã§ã¯ã€`/etc/wsl.conf` ã‚’ä½¿ã£ã¦ç´°ã‹ã„å‹•ä½œã‚’è¨­å®šã§ãã¾ã™ã€‚
systemd ã®è¨­å®šã‚‚åŒæ§˜ã§ã™ã€‚

### 1.1 systemdã®æœ‰åŠ¹åŒ–

systemd ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã§`/etc/wsl.conf`ã« systemd ã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚

```mermaid
graph TD
A[Debianã®èµ·å‹•] --> B[viã‚¨ãƒ‡ã‚£ã‚¿ã§`/etc/wsl.conf`ã‚’é–‹ã]
B --> C[è¨­å®šã‚’è¿½åŠ ]
C --> D[ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜]
D --> E[çµ‚äº†]
```

ã“ã®è¨˜äº‹ã§ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿`vi`[^3]ã‚’ä½¿ç”¨ã—ã¦`/etc/wsl.conf`ã‚’ç·¨é›†ã—ã€systemd ã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚
`vi`ã‚¨ãƒ‡ã‚£ã‚¿ã®è©³ã—ã„ä½¿ã„æ–¹ã¯ã€[Vimæ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vim-jp.org/vimdoc-ja/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

æ¬¡ã®æ‰‹é †ã«ã—ãŸãŒã£ã¦ systemd ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚

1. vi ã‚¨ãƒ‡ã‚£ã‚¿ã§`/etc/wsl.conf`ã‚’ç·¨é›†
   `bash`ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

   ```bash
   sudo vi /etc/wsl.conf
   ```

   ![viã‚¨ãƒ‡ã‚£ã‚¿ã®èµ·å‹•](https://i.imgur.com/Xs4trxo.png)

2. `/etc/wsl.conf`ã®è¨­å®š
   `/etc/wsl.conf`ã«æ¬¡ã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™

   ```conf: /etc/wsl.conf
   [boot]
   systemd=true
   ```

   ![wslconfã®è¨­å®š](https://i.imgur.com/JS9dMgH.png)

3. `/etc/wsl.conf`ã®ä¿å­˜
   ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰[^4]ã§`:wq`[^5]ã¨å…¥åŠ›ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¾ã™ã€‚

ä»¥ä¸Šã§ã€`/etc/wsl.conf`ã®è¨­å®šã¯çµ‚äº†ã§ã™ã€‚
Debian ã‚’å†èµ·å‹•ã™ã‚‹ã¨ã€systemd ãŒæœ‰åŠ¹ã¨ãªã‚Šã¾ã™ã€‚

[^3]: `vi`: Linuxä¸Šã§åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿
[^4]: ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰: `vi`ã®ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã® 1ã¤ã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã§ãã‚‹ãƒ¢ãƒ¼ãƒ‰
[^5]: `:wq`:  `vi`ã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¦çµ‚äº†ã•ã›ã‚‹ã‚³ãƒãƒ³ãƒ‰

## 2. Debian ã®å†èµ·å‹•

ã“ã“ã§ã¯ã€systemd ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ãŸã‚ã«ã€WSL 2 ä¸Šã® Debian ã‚’å†èµ·å‹•ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

### 2.1. Debianã‚’å†èµ·å‹•ã™ã‚‹

 `Windows Terminal` [^6] ã§`wsl`ã‚³ãƒãƒ³ãƒ‰[^7]ã‚’ä½¿ã„ã€Debian ã‚’å†èµ·å‹•ã—ã€systemd ã‚’æœ‰åŠ¹åŒ–ã—ã¾ã™ã€‚

```mermaid

graph TD
A[Windows Terminalã®èµ·å‹•] --> B[wslã‚³ãƒãƒ³ãƒ‰ã§Debianã‚’åœæ­¢]
B --> C[`Windows Terminal`ã§Debianã‚’èµ·å‹•]
C --> D[çµ‚äº†]

```

1. Debian ã®åœæ­¢
   `wsl`ã‚³ãƒãƒ³ãƒ‰ã§ã€Debian ã‚’åœæ­¢ã—ã¾ã™ã€‚

   ```powershell
   wsl --terminate Debian
   ```

   ![Debian ã®åœæ­¢](https://i.imgur.com/trnkY0S.png)

2. Debian ã®å†èµ·å‹•
    `Windows Terminal`ä¸Šã§ Debian ã‚’é¸æŠã—ã¦ã€Debian ã‚’å†èµ·å‹•ã—ã¾ã™ã€‚

ä»¥ä¸Šã§ã€Debian ã®å†èµ·å‹•ã¯å®Œäº†ã—ã¾ã—ãŸã€‚

[^6]: `Windows Terminal`: Windowsä¸Šã§è¤‡æ•°ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
[^7]: `wsl`ã‚³ãƒãƒ³ãƒ‰: `Windows Subsystem for Linux`ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰

## ãŠã‚ã‚Šã«

ã“ã®è¨˜äº‹ã§ã¯ã€WSL 2 ä¸Šã® Debian ã§ systemd ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚
systemd ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã“ã¨ã§ã€Linux ç’°å¢ƒã®å¤šãã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ Windowsä¸Šã§ã‚‚åˆ©ç”¨ã§ãã¾ã™ã€‚

é–‹ç™ºã‚„ãƒ†ã‚¹ãƒˆç’°å¢ƒãŒæŸ”è»Ÿã«ãªã‚Šã¾ã™ã®ã§ã€æ˜¯é systemd ã‚’æœ‰åŠ¹åŒ–ã—ã€WSL 2 ã‚’æœ€å¤§é™ã«æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚

ãã‚Œã§ã¯ã€Happy Hacking!

## å‚è€ƒè³‡æ–™

### systemd

- [systemd - Wikipedia](https://ja.wikipedia.org/wiki/Systemd)

### Microsoft Learn

- [WSL ã§ã®è©³ç´°è¨­å®šã®æ§‹æˆ](https://learn.microsoft.com/ja-jp/windows/wsl/wsl-config)
- [WSL ä¸Šã§ systemd ã‚’ä½¿ç”¨ã—ã¦ Linux ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã™ã‚‹](https://learn.microsoft.com/ja-jp/windows/wsl/systemd)

### `vi`ã‚¨ãƒ‡ã‚£ã‚¿

- [Vimæ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vim-jp.org/vimdoc-ja/)
